# EyeLink Operations Guide

'''<span style="color:blue">Quick Start Guide, Manuals etc. can be found [https://www.chbh.bham.ac.uk/wiki/index.php/Manuals#EyeLink_1000_Plus[HERE]].</span>'''

## Initial Setup
	
* '''Switch on''' the bar plug ('''next to EyeLink Host PC'''), to provide power to the '''Host PC, PC monitor & EyeLink camera'''.<br /><br />

* '''EyeLink battery'''. Press the '''TEST button''' to check the power level ('''batteries #1 and #2'''), or '''power on and press the TEST button''' ('''batteries #3 and #4'''). '''Use a fully charged battery''' if possible. 
** '''<span style="color:maroon">A battery with 2-3 hours should be fine for a short experiment. Do not risk using it for a 2-hour experiment.</span>'''<br /><br />

* '''Take the battery into the MSR''' and place '''in front right hand corner'''. '''Arrange''' the power cable '''around the inside wall of the MSR to avoid any loops''', and '''attach to battery and FO camera head/IR Illuminator'''. '''Switch on the battery.'''
** '''<span style="color:red">NOTE:</span> Ensure you make good cable connections (the black rubber strain reliefs aren't pushed up over the silver two-pin connectors).'''
** '''<span style="color:red">NOTE:</span> If you don’t power the camera head/IR Illuminator first, the Host PC will complain slightly (ticking sound) when EyeLink starts up.'''
** '''<span style="color:maroon">To prevent small threshold drifts, the EyeLink Camera Head/Host PC etc should be powered up/switched on for <span style="color:red">at least 5 minutes</span> before recording.</span>'''<br /><br />

* '''Remove the lens cap''' from the '''FO camera head''', and '''place the FO camera head/IR Illuminator on the small table in front of the gantry'''. <br /><br />'''

* '''<span style="color:blue">If using Monocular</span>''', make sure '''the FO camera head is [https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/Horizontal.jpg HORIZONTAL]''', and '''the knurled silver adjustment knobs''' are '''centered to the projector screen.'''<br />
** Once your participant is in place, tilt the camera head/illuminator as necessary to bring the eye into view, making sure to keep everything '''as level as possible'''.<br />

* '''<span style="color:blue">For Binocular use, you will need to change the position of the camera head</span>'''.
** '''Note the value on the bar scale''' (as indicated by the '''<span style="color:red">RED line</span>''' in the image below) '''before undoing the knob''', and make sure '''the camera mount is back at that value on the bar''' after adjusting the camera head and '''before tightening the knob'''.
** '''Undo the black knurled knob''' (circled '''[https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/Black_Knurled_Knob.jpg HERE]''' in '''<span style="color:blue">BLUE</span>''') to allow the camera head '''to be pulled slightly away from the bar, exposing the brass fixing pins''' (circled '''[https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/Brass_Fixing_Pins.jpg HERE]''' in '''<span style="color:green">GREEN</span>''').
** '''Adjust the camera head on an angle, aligning the pins''' to the '''secondary/"binocular" position''' (shown '''[https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/Binocular_position.jpg HERE]''') and then '''push the camera head back into place, tightening the black knurled knob'''. '''[https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/Binocular_front_view.jpg HERE]''' is a '''front view of the camera head in the binocular usage position'''.
** Make sure you '''haven’t slid the camera mount closer or further away''' from the IR illuminator '''when adjusting''' (as indicated by the '''<span style="color:red">RED line</span>''' in the images mentioned above).


* If you need to, '''Raise the small table''' (using the '''black plastic risers''', 3 heights available (this '''[https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/TableRisers.jpg IMAGE]''' shows the smallest height in use), so that the '''top''' of the IR Illuminator is as '''close as possible to the lower edge of the projector screen.'''

[[File:EyeLink-1.jpg|200px|thumb|left|EyeLink clip position adjustment]]<br />

* '''Camera Head and Illuminator Separation''':  Adjust the camera and Illuminator '''clip positions''' on the mounting bar so that the '''inner edges''' aligns with the '''eye-to-camera distance measured in cm.'''
** '''<span style="color:maroon"> When using the small table, the separation should be already adjusted. Only if moving closer or further away will you need to make some adjustments.</span>'''
* '''<span style="color:blue">Gaze tracking range: 32<sup>o</sup> horizontally, 25<sup>o</sup> vertically </span>'''<br /><br /><br />

* '''Switch on''' the '''EyeLink Host PC & monitor'''. Select the default '''EyeLink''' partition from the '''Windows Boot Manager''' interface.<br /><br />

* Select the appropriate '''EyeLink Configuration''' from the '''Set Options''' screen, e.g. '''monocular''', '''binocular'''.
** From '''Set Options''', select '''Long Range Mount''' in the Configuration window ('''may already be highlighted''') - see this '''[https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/LongRangeMount.jpg IMAGE]'''
** Then select '''Select Config...''' and choose either '''[https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/Monocular.jpg Monocular]''' or '''[https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/Binocular.jpg Binocular]''' and click on '''Accept'''.
*** You should then see something similar to this '''[https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/Monocular_eye.jpg IMAGE for Monocular]''' and this '''[https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/Binocular_eyes.jpg IMAGE for Binocular]'''.
**** '''<span style="color:maroon">Make sure the sample rate is changed back to 1K for Binocular usage</span>''' (as indicated by the '''<span style="color:red">red arrow</span>''' in the image). '''<span style="color:red">The sample rate defaults to 500 when selecting Binocular</span>'''.
**** You will need to '''adjust the view of the Head when using Binocular''', as the '''angle of the camera head has changed'''. '''Click the top right-hand blue square''' (as indicated by the '''<span style="color:blue">blue arrow</span>)''' to '''display the correct view''' 
***** '''(Note: If the view is still not correct, you may also need to adjust the top left-hand blue square as necessary)'''.<br /><br />
	
* If possible, have the participant '''remove any mascara''', and replace glasses with our MEG-safe glasses. '''Soft contact lenses can be worn''' during an eye-tracking experiment, but '''hard contact lenses may interfere''' with the '''corneal reflection (CR)''' and thus need to be switched for MEG-safe lenses using our GoPro/Loc-Line assembly.<br /><br />

<span style="color:green"><span style="font-size:medium">'''Information:'''</span><br />
'''Mascara.''' Eye lashes with mascara will show very dark on the eye image, which can have a negative effect on pupil detection. Mascara shouldn’t be used in the MEG in any case, due to the possibility of metal particles in the makeup.<br />
'''Soft contact lenses''' usually work quite well. The edge of lens can be seen from the eye image as pale ring, but it doesn’t usually have an effect on the eye tracking. Lenses can also create an extra reflection point, which is very similar to a corneal reflection (1st Purkinje image), but is normally only visible at certain angles.<br />
'''Hard lenses''' don’t usually work with the EyeLink. They tend to be less stable than soft lenses and can slide partly off the centre of the eye. This will produce an eye image, where the pupil is partially cut off.<br />
'''MEG-glasses'''.  The EyeLink will work with our MEG-safe glasses, but it needs to be adjusted very carefully. The lenses may reflect IR light, which can disturb the eye tracking. Also the success rate for good tracking is lower with the glasses than without.</span><br /><br />

## Focusing

* '''Align the camera:'''  Once the participant is positioned in the gantry, point/tilt the camera '''at the eye to be tracked''' so that the eye appears in the '''centre of the global view''' ('''[https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/Monocular_eye.jpg TOP IMAGE WINDOW]''' on the '''‘Camera Setup’''' screen), undoing/tightening the silver knurled knobs, remembering to '''keep the camera/IR illuminiator as level as possible'''.<br /> You may need to '''move the whole Desktop Mount left/right slightly''' so that the '''patch of the light''' is '''aligned with the field of view of the camera'''.
* If '''tracking the left eye''', the '''Illuminator''' is usually '''on the right side''', but the position maybe irrelevant for binocular eye tracking.
* '''Focus the camera image''' if it looks blurred (by turning the lens wheel). The '''aperture''' ring is the smaller of the two, and probably doesn’t need adjusting. 
** '''NOTE:''' When using '''Psychtoolbox (PTB)''', the '''EyeLink image''' can be thrown '''onto the projector screen''' to make focusing easier. The '''left/right arrows''' on the '''Stim PC''' toggle '''between wide angle view and eye focused view'''.
*** To throw the image, start '''TRACK''' (either as a standalone program or as part of your stimulus code - see the '''Calibration''' section below). You should see this '''[https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/Offline.jpg SCREEN]'''
*** Press "'''ENTER'''" to '''start camera setup''' (you should see this '''[https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/Camera_Setup.jpg SCREEN]'''), and then press "'''ENTER'''" again to '''show the camera image''' (the '''[https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/Eye.jpg EYE]''')
** '''<span style="color:blue">A good guide is to check the eyelashes are in focus; when they are sharp the image is usually good enough.</span>''' <br /><br />

<span style="color:green"><span style="font-size:medium">'''Information:'''</span><br />
Ideally when recording from one eye, the eye movements should be measured from the participant’s dominant eye – but this is the optimal solution and not necessarily essential to obtaining good eye tracking.<br />
If you want to use the dominant eye, examples to find the dominant eye are shown below:<br />
1) '''Extend your arms out in front of you''' and create a triangular opening between your thumbs and forefingers by placing your hands together at a 45-degree angle.<br />
With both eyes open, centre this triangular opening on a distant object - such as a wall clock or door knob.<br />
Close your left eye.<br />
If the object stays centred, your right eye (the one that's open) is your dominant eye.<br />If the object is no longer framed by your hands, your left eye is your dominant eye.<br />
2) '''Extend one arm out''', holding the thumb (or index finger) of that hand in an upright position.<br />
Keeping both eyes open and focused on a distant object, superimpose your thumb/index finger on that object. Don't worry if it looks like your thumb/finger partially disappears - that’s normal.<br />
Alternately close one eye at a time.<br />
The eye that keeps your thumb/finger directly in front of the object while the other eye is closed is your dominant eye.</span><br /><br />

* '''Roughly focus''' on the eye using the '''wide angle view on the projector screen'''.

* '''Set the search limits''' on the Eyelink PC by '''clicking on''' the '''pupil''' and '''auto- threshold.'''

* '''Switch to eye-view''' (arrow key) and '''focus using the corneal reflection'''. The '''focus is best''' when the '''corneal reflection is smallest (sharp)'''.

* On the EyeLink PC, '''press auto-threshold''' and check whether '''pupil values''' (identified by the '''blue shading''') are '''between 75-100''' and '''corneal reflection  is less than 230''' (identified by a '''yellow circle with crosshair'''). If needed, manually adjust. If sub-optimal, then the Illuminator focus may need adjusting (see below).<br />
* If the '''pupil crosshair flickers on/off''', or '''disappears''' even though the '''pupil is visible''', then the pupil '''size''' maybe '''too small'''. Check the '''camera distance'''. Consider placing the '''Desktop Mount closer to the participant'''.

* '''<span style="color:blue"> A good check is to ask your participant to look along the edges/four corners of the display and ensure that the pupil and corneal reflection do not get lost.</span> 

[[File:IlluminatorAdjustment.jpg|200px|thumb|left|Illuminator Focus Adjustment]]<br />

* For '''focusing the Illuminator''', loosen the '''2 screws on the underside''' of the Illuminator and then '''adjust the cover''' so that its edge aligns with the '''marking that approximates the eye-to-camera distance''' and then tighten the screws. <br /><br /><br />


<span style="color:green"><span style="font-size:medium">'''Information:'''</span><br />
'''Pupil threshold:''' Fill the dark pupil with blue colour. If there isn’t enough colour inside the pupil, adjust the pupil threshold level up. If there is too much blue colour around the pupil, change the threshold level down. Pupil value should be between 75 and 115. If the pupil threshold is too high or too low, try increasing or decreasing the eye-camera distance. <br />
[[File:PoorPupilThreshold.jpg]]<br /><br />
'''Corneal reflections:''' You want a small CR as possible, showing the pupil is in focus. If there is a white halo around the turquoise reflections, adjust the CR threshold level down. Also adjust the focus of the camera. Corneal reflections should not exceed 240. If the corneal thresholds are too high, try increasing the eye-to-camera distance.<br />
CR smearing is typically seen when the participant looks top-left or top-right of the display, indicating the viewing angle is too large for the setup. Try raising the Desktop mount and/or increasing the view distance.<br />
[[File:PoorCornealReflection.jpg]]<br /><br />
'''Correct detection:''' When both the pupil and CR are detected correctly, you will see the '''GREEN boxes''' showing ‘PUPIL OK’ and ‘CR OK’</span>


* Default settings for the display resolution of EyeLink are set to '''1920 x 1080''' in the '''PHYSICAL.INI''' file that specifies the settings ('''screen_pixel_coords = 0.0, 0.0, 1920.0, 1080.0'''). It’s important that it is '''matched with the actual display resolution''' you use, as the '''calibrated gaze data is in pixels'''. If you use a different display resolution, you can change the settings, but don’t do this in the PHYSICAL.INI file. Rather, '''copy''' the command line to the '''FINAL.INI''' file and change the setting there (this will override the settings in the PHYSICAL.INI file). '''All setup files''' (.ini files) are stored in the '''‘C:\ELCL\EXE’''' directory. '''Remember to reset it to the default setting after you finished your experiment!''' The best way to set the display resolution is to have your script send a command to the Host PC to update this parameter based on the resolution you are using. For example ...
** '''<span style="color:blue">Eyelink('Command', 'screen_pixel_coords = 0 0 1920 1080');</span>'''

'''<span style="color:maroon">Check which eye is being tracked in the EyeLink Host Computer!</span> (the last known settings are used, which may be different to your own settings).'''<br /><br />

## Calibration

<span style="color:green"><span style="font-size:medium">'''Information:'''</span><br />
When writing your own applications, '''try to match the background colour of the screen during calibration and validation to that of the test displays'''. Changes in pupil size caused by large brightness differences can degrade the system accuracy.<br />
A velocity threshold of 22 degrees per second allows detection of saccades as small as 0.3<sup>o</sup>, ideal for smooth pursuit and psychophysical research. <br />A conservative threshold of '''30<sup>o</sup>/sec is better for reading''' and cognitive research, shortening saccades and lengthening fixation durations. The larger threshold also reduces the number of microsaccades detected, decreasing the number of short fixations (less than 100 msec in duration) in the data.<br />
Use of eye-movement acceleration is important for detection of small saccades, especially in smooth pursuit.<br />Acceleration data has much more noise than velocity data, and thresholds of '''4000<sup>o</sup>/sec<sup>2</sup>''' for small saccade detection and
'''8000<sup>o</sup>/sec<sup>2</sup>''' for reading and cognitive research are recommended.<br />
'''Check your sample rate:''' Lowering the sample rate to less than 2K can help with the stability of the eye tracker. '''Our Default is 1000Hz for both monocular and binocular'''.<br />


'''<span style="color:blue">Useful links to EyeLink PTB code on Github can be found [https://github.com/Psychtoolbox-3/Psychtoolbox-3/blob/fab0b49fd38ec477e3b4573f23dbd7766b0a89aa/Psychtoolbox/PsychHardware/EyelinkToolbox/EyelinkBasic/EyelinkDoTrackerSetup.m[HERE]] and [https://github.com/Psychtoolbox-3/Psychtoolbox-3/search?q=eyelinktoolbox&unscoped_q=eyelinktoolbox[HERE]].</span>'''<br />
'''<span style="color:blue">Our in-house code (<span style="color:red">''Eyelink_Demo.m''</span>) can be found [https://github.com/MEGSupportCHBH/TheCHBH/tree/master/MEGEyelinkDemoCodeCHBH[HERE]] (Many thanks to Dr. Yali Pan).</span>'''<br />


* '''Set the desired Calibration and Validation settings.''' 
** From the '''Set Options''' screen (shown '''[https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/LongRangeMount.jpg HERE]''') choose the '''Calibration Type''' and '''Pacing Interval'''. '''<span style="color:blue">Our Default is a 9-point grid and 1sec interval</span>'''.<br /> 9-point calibration is standard, but '''participants who find that difficult''' can be given an '''easier 5-point or 3-point''' calibration. '''Click on the relevant "Type" as necessary.'''
** It is '''recommended to perform the calibration in a randomized order''', so make sure the '''Randomize Order''' box is selected.
** Uncheck/disable '''Force Manual Accept''' if you '''want the fixation point to move automatically''' once the '''first calibration position is registered'''. Otherwise, you will '''need to press the spacebar or ENTER key on the Stim or Host PC to gather the next sample once the participant has fixated their eyes'''.<br /><br />

'''<span style="color:blue">The following steps are echoed/replicated in Yali's example code, <span style="color:red">''Eyelink_Demo.m''</span>.</span>'''<br /><br />

* Start '''TRACK.EXE''' on the Stim PC ('''Programs - SR Research – EyeLink - Track'''), or run your MATLAB PTB code if you incorporated Yali's code into your paradigm.<br />'''<span style="color:maroon">NOTE: Our ADMIN account password may be required. If so, it's "chbh-stim".</span>'''
** This '''[https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/Offline.jpg SCREEN]''' should appear.
** Press "'''ENTER'''" to '''start camera setup'''. This '''[https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/Camera_Setup.jpg SCREEN]''' should appear.


* <big><span style="color:maroon">Begin '''Calibration''' by pressing the '''"C"''' key</span></big>, or the "'''Calibrate'''" button from the '''camera setup''' menu on the '''EyeLink Host PC'''.<br />The '''first fixation point''' needs to be '''manually accepted by pressing the spacebar/ENTER key'''. 
* On the screen, you will '''see a letter "D"''' ('''<span style="color:green">in green (left eye)</span>''' and '''<span style="color:blue">blue (right eye)</span>''', '''which moves when the participant moves their eyes'''. When the '''"D's" (pupils) appear stable on the fixation point''', press '''‘Accept Fixation’''', or the '''"ENTER"''' button or spacebar to '''accept the first fixation''', then '''let the sequence run by itself''', if you previously unchecked '''Force Manual Accept''' ('''NOTE: you may have to press the spacebar to start the calibration'''). 
* '''Whenever the participants' gaze reaches a fixation/calibration point''', a '''white cross''' will '''appear on the EyeLink Host PC'''.<br /> '''<span style="color:blue">For a 9-point calibration, you want these crosses to form a perfect grid.</span>'''
* To achieve that, '''instruct''' your participant to '''focus on the centre of the fixation points and not to change their gaze until the fixation point disappears'''.
** '''"Please don't move your head".'''
** '''“Please look at the middle of the dot”.'''
** '''“Please don't move your eyes until the dot moves”.'''
* Even if '''you’re not running an eye tracking experiment''', but are '''only monitoring pupil size''', it is '''recommended to do at least a 3-point calibration'''.
* '''<span style="color:blue">Use the "Backspace" key to undo recent calibration targets if they are proving problematic to collect.</span>'''
** '''With each press''', the '''data collected for the last point in the calibration sequence is erased''' and '''new calibration data can then be collected'''.<br /> This can be '''used to improve calibration accuracy for one or few selected points without having to restart calibration'''. <br />'''Especially helpful for those participants whose calibration data is hard to get.'''
* When '''the last calibration target has been presented''', the '''calibration will be evaluated'''.<br />At the '''bottom of the Calibrate screen''', each '''eye's calibration is graded and displayed''' as follows:<br>
** <big>'''<span style="color: white;background-color: #0BDA51"> GOOD </span>'''</big>'''   (green background): No obvious problems found with the data.<br />
** <big>'''<span style="color: white;background-color: red"> FAILED </span>'''</big>'''   (red background): Could not use data, calibration must be repeated.<br />
** '''An example of a "GOOD" result is shown below.'''

[[File:Eye_Calibration_Graded.jpg]]

* '''A "GOOD" calibration is also indicated by a regular pattern of parallel horizontal and vertical lines formed by the calibration fixation crosses. See the image below.'''

[[File:Good_Poor_Calibration.jpg]]

* If you're happy the '''calibration was successful''', press the '''‘Accept’''' or '''"ENTER"''' button to '''accept the result''', press '''‘Restart’''' or the '''"ESC"''' button to '''restart the calibration'''.
* '''Pressing "ESC" twice exits to the Camera Setup screen.'''
** '''<span style="color:red">NOTE:</span>''' '''If you want to keep the current calibration, NEVER press the "ESC" key at the calibration end when the calibration grid is displayed.'''
** '''<span style="color:red">NOTE:</span>''' '''Doing so will DISCARD the current calibration, and the software will revert to any existing cached calibration. You may then need to recalibrate.'''


## Validation

* <big><span style="color:maroon">Begin '''Validation''' by pressing the '''"V"''' key</span></big>, or the '''"Validate"''' button from the '''camera setup''' menu on the '''EyeLink Host PC'''.<br />A '''round, coloured, cursor''' will '''show the participant's gaze position'''.
* Once the '''cursor appears stable and close to the target''', press '''"ENTER"''' to '''manually accept the first fixation''', then '''let the sequence run by itself''', or '''manually accept''' each fixation by pressing '''"ENTER"'''.
* '''Every time''' the participant’s gaze '''reaches a validation point''', a '''cross is displayed''' to '''mark its computed position relative to the target''' and a value ('''degrees of deviation''') appears on screen next to it.<br /> '''<span style="color:red">All these values need to be below 1 degree of error.</span>'''
* As with the '''Calibration''' procedure, if necessary '''<span style="color:blue">use the "Backspace" key in the middle of a Validation sequence to redo data collection</span>''' for the '''last''' or '''last few Validation points collected'''.  
* After '''the final fixation is collected''', the '''average and maximum errors are displayed at the bottom of the screen''', and the '''accuracy is scored'''.<br />'''Each eye is graded separately, using coloured messages similar to the calibration results:'''<br>
** <big>'''<span style="color: white;background-color: #0BDA51"> GOOD </span>'''</big>'''   (green background): Errors are generally acceptable.<br />
** <big>'''<span style="color: white;background-color: grey"> FAIR</span>'''</big>'''   (grey background): Errors are moderate, calibration should be improved.<br />
** <big>'''<span style="color: white;background-color: red"> POOR </span>'''</big>'''   (red background): Errors are too high for useful eye tracking.<br />
*** '''View the pattern of errors for each target position'''.<br />'''If only one target has a large error''', the participant may have '''simply mis-fixated that point''', and the '''validation can be repeated to check this''': '''press "ESC" to return to the Camera Setup screen, and press "V" to repeat the validation'''.<br />'''If a systematic pattern of error is seen''' (i.e. '''all fixations''' on '''the left side are too low''') there is '''probably a calibration or camera setup problem'''. In this case, '''press "ESC" to return to the Camera Setup screen, adjust the set-up as needed, and repeat the calibration'''.
* '''Repeat the Calibration''' if '''Validation is poor''' ('''<span style="color:red">deviations of more than 1 degree are observed for each point</span>''').
* Press '''"Accept"''' or '''"ENTER"''' when you're happy with the Validation results.  
* Close '''"Track"''' if the '''Validation is good'''. If '''using EyeLink PTB code''', pressing '''“ESC”''' will '''exit to your experiment (ending the calibration/validation routine)'''.<br /><br />

## Run Experiment

'''<span style="color:red">NOTE: </span>''' If you receive an '''error message''' and the Tracker software '''fails to start''' when you first turn on the EyeLink PC - the partition could be '''full'''. Try '''deleting''' some of the older EDF files from the '''exe''' ('''/elcl/exe''') directory via the '''File Manager.'''

* '''Start your experiment'''. Make sure that the '''EDF filename/Participant Name''' to store your data '''does not exceed 8 characters''' otherwise it may not properly transfer your data at the end of the experiment (you will get an error when the EDF file is copied to our Stim PC). Or worse, data from a previous session could be overwritten.
** '''<span style="color:maroon">This is an old DOS naming convention (older EyeLink trackers run on DOS). SR Research have kept to this file naming convention, even with newer Windows-based eye trackers, for consistency.</span>'''
** '''(For more detailed information, if you're interested, check out this Wiki page [https://en.wikipedia.org/wiki/8.3_filename[8.3 Filename]])'''

* '''When the experiment is finished''', the EyeLink PTB code should '''exit''' you from the Host PC application to the '''File Manager'''. If not, press '''‘CTRL+ALT+Q’''' to exit the EyeLink 1000 Host PC application, or select '''‘Offline’''' then '''‘Exit EyeLink’'''.
** '''<span style="color:maroon">If the battery, or AC Power, is switched off BEFORE you exit the EyeLink Host PC application, the PC will complain (loud beeping). Repower the camera head/illuminator, and then exit the Eyelink application back to the File Manager and then switch off the battery.</span>'''
 
* If you’re the '''last user of the day''', switch off the EyeLink battery, '''remove/tidy up the FO cable/power cable''', and '''remove''' the battery from the MSR – putting it back on charge (if possible, otherwise leave a note for Jonathan to put it on charge the following morning - attach a piece of Micropore tape). '''Replace the lens cap''' on the FO camera head, and put the FO camera head/IR Illuminator '''back on a shelf''' in the MSR cabinet. 
* '''Copy off''' any required '''EyeLink Data Files (EDF)''' (''see'' '''<span style="color:blue;font-size:large">@</span>''' ''below'') from the Host PC, or check that your EDF files '''were copied automatically''' to the Stim PC (if your code is set up to do that) ...
* ... and then shut down the Host PC. 
** From the '''‘File Manager’''' interface, select the '''‘Power’''' button (top right), or '''“Shutdown Host”''' from Eyelink screen. Switch off the monitor, and then switch off the bar plug on the table. 
* '''Sleep''' the PROPixx projector etc. See '''[[Tidying Up]]'''.
 
'''<span style="color:red">HOTKEYS</span>'''
* '''ENTER''' - show eye on monitor 
* '''Left/Right''' – switch between zoomed in/zoomed out image
* '''C''' - calibration 
* '''SPACE''' - start calibration 
* '''ENTER''' - accept calibration 
* '''V''' - validation 
* '''SPACE''' - start validation 
* '''ENTER''' - accept validation


'''<span style="color:blue;font-size:large">@</span> <span style="font-size:large;color:green">September 2020:</span> '''

The '''EyeLink Host PC software''' has been '''updated from 5.14 to 5.15''', to help Oscar troubleshoot his stimuli.

Most of the changes are under-the-hood, so should be transparent to your usage. The only change that might impact you, is that the '''default storage location of EDF files''' on the '''Host PC''' has been '''changed''' from the '''Data subfolder''' to the '''Exe subfolder'''.

'''<span style="color:maroon;font-size:medium">Sam from SR Research</span> says''' ...'''<span style="color:blue;font-size:medium">"The location of the EDF file on the Host PC should be irrelevant for most users as the EDF should always be transferred to the stimulus display PC at the end of the task - the copy on the Host PC is really just there as a back up in case people somehow lose or delete the copy on the display PC. But letting people know will hopefully prevent any panics if people go looking in the data subfolder and don't see any EDFs!" </span> '''


## Troubleshooting

 '''Ensure the MSR is as dark as possible when trying to find the pupil and when undertaking the calibration e.g. close the door, or push the door to. Turn the lights down or off'''.
 '''If you're still having issues, ask your participant to close their eyes for a few seconds to reset the pupils.'''
 '''If your participant is tall, place the relevant-size table risers under the table legs, so the camera is more in line with their pupils. We have 3 heights available. This [https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/TableRisers.jpg IMAGE] shows the smaller risers in use.'''
 '''To check focusing, look at the eyelashes. When they are in sharp focus the image of the eye is usually good enough.'''
 '''To help with Calibration quality, ask your participant to look along the edges/four corners of the display after performing the camera setup. <br />Be sure to instruct your participant to fixate within the bounds of the display, or loss of tracking may occur because they have looked too far outside of the trackable range of the eye tracker, not because of a poor set-up.<br /> Watch for the warning signals on the tracker screen to make sure that the pupil and Corneal Reflection (CR) signal are not lost when the participant is doing so, and check the CR is not becoming distorted or "smeared" when the participant looks at the top corners.<br >Try adjusting the screen position to increase the viewing distance and raising the camera when CR smearing is seen (typically at the upper portion of the display). We have our table risers to help with this.'''
 '''Participants who have never been calibrated before may require some practice in stably and accurately fixating the calibration targets.<br />Try to perform at least two calibrations per participant before beginning to collect data.'''
 '''Always check the pattern of the calibration grid.<br /> For a 9-point calibration, the fixation crosses should form three parallel horizontal (or close-to-horizontal) lines and three parallel vertical (or close-to-vertical) lines.<br />Redo the calibration or camera setup if you do not see this.''' 
 '''If the current calibration looks good, press either the "ENTER" key to accept the calibration or press "V" to go to validation screen.<br />Never press the ESC key - doing so will discard the current calibration and thus revert to the cached calibration results.'''
 '''Encourage your participants to sit still! A participant who doesn't sit still probably is not paying proper attention to the experimental task.<br /> Try to give the participant a short break in the middle of the experiment and (if possible) recalibrate before resuming the experiment.'''
 ''' When writing your stimulus paradigms, try matching the background color of the calibration and validation screen to that of the experimental displays.<br /> Changes in pupil size caused by large changes in brightness between the calibration and the experimental displays will degrade the system accuracy.<br />At the beginning of the experiment, let your participant adapt to the environment and the ambient light levels before performing calibration and data collection.<br />If the illumination levels are altered (i.e. the lights are dimmed) shortly before the experiment begins, the calibration accuracy will be reduced as the participant adapts to the new illumination level and the pupil dilates or constricts.''' 
 '''If the validation is off, redo BOTH the calibration and the validation. <span style="color:blue">Validation deviation needs to be less than 1 degree of error.</span>'''
 '''Calibration improves when you:'''<br />
 '''Tell your participant to "not move your head".'''<br />
 '''Tell your participant to “look at the middle of the dot”.'''<br />
 '''Tell your participant to “not move your eyes until the dot moves”.'''
 '''If the Eyelink Host PC starts to beep, either the battery has run down or the battery has been switched off BEFORE the EyeLink software has been exited first.'''
 '''CALIBRATION BEEPS:'''<br /> ('''''some Participants reported the beeps are too loud through our Natus audio system''''')
 '''If using Experiment Builder, click on the EL_CAMERA_SETUP node and turn the relevant properties from 'DEFAULT' to 'OFF'. See this [https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/ExptBuilderBeeps.png IMAGE]'''
 '''If using Psychotoolbox (MATLAB) or PsychoPy, some commands can be sent to the Host PC to turn the beeps off. E.g. in Psychotoolbox set these parameters to '0' instead of '1'. See this [https://www.chbh.bham.ac.uk/wiki/buic-files/MEG/PsychtoolboxBeep.png IMAGE]'''
 '''OLDER PARTICIPANTS:<br /> The biggest problem is likely to be ''ptosis'' (droopy eyelids). The top eyelid can obscure the top of the pupil, making it difficult for the eye tracker to determine the pupil’s centre.'''
 '''Whilst monitoring the thumbnail images of the eye(s), it may help to issue verbal prompts to “''try and keep your eyes wide open''” as often as necessary.'''
 '''On the ''Camera Setup'' screen, changing the ''Pupil Tracking'' from ''Centroid'' to ''Ellipse'' can sometimes help. In Ellipse mode, the Host software draws a green circle around the pupil and tracks the centre of the circle. This sometimes helps the tracking cope a bit better if the top of the pupil is obscured by the eyelid.'''
 '''Rather than reduce the light levels, increase them or have the MSR lights on full. This will cause the pupil size to decrease, and smaller pupils are easier to track in this context. In low light conditions, the pupil will expand making it more likely to be obscured by the eyelid and harder to track.''' 
 '''Moving the camera head/illuminator closer, rather than raising it, may also help, as looking up at the eye at a steeper angle may expose more of the smaller pupil.'''
 '''When recruiting older participants, ask if they have had eye surgery (particularly cataract removal). This can cause corneal scarring and result in flat spots on the cornea, both of which can make tracking difficult or impossible and may discount them as a potential experimental subject if recording eye movement is vital.'''

